<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ruang Data Telemedia</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
  <link rel="stylesheet" href="css/self.css" />
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
</head>

<body>
  <!-- Overlay klik -->
  <div id="click-overlay">Klik di mana saja untuk memulai</div>

  <!-- Konten utama -->
  <section class="form-login container mt-5 pt-2" id="main-content" style="display: none;">
    <form class="mt-3" action="#" method="post">
      <div class="row g-4 justify-content-center">
        <div class="col-lg-6 col-md-10 col-12">
          <div class="login-row-area shadow-sm p-4 bg-white rounded">
            <div class="login-opening text-center mb-4">
              <img class="img-fluid" src="assets/logo.png" alt="RuangData" style="max-height: 80px;">
            </div>
            <div class="login-row">
              <p class="login-form-title">MASUKAN NOMOR :</p>
              <input type="text" class="form-control text-center fs-4" id="formatted-phone" autocomplete="off" autofocus readonly required>
              <input type="hidden" id="raw-phone" name="nomor" required>
            </div>
            <div class="login-btn-area text-center mt-4">
              <button class="login-btn px-5 py-2 shadow-sm" type="submit">LANJUTKAN</button>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-8 col-12">
          <div class="calculator shadow-sm bg-light p-4 rounded">
            <div class="row g-2">
              <div class="col-4"><a class="button w-100" data-number="1">1</a></div>
              <div class="col-4"><a class="button w-100" data-number="2">2</a></div>
              <div class="col-4"><a class="button w-100" data-number="3">3</a></div>
              <div class="col-4"><a class="button w-100" data-number="4">4</a></div>
              <div class="col-4"><a class="button w-100" data-number="5">5</a></div>
              <div class="col-4"><a class="button w-100" data-number="6">6</a></div>
              <div class="col-4"><a class="button w-100" data-number="7">7</a></div>
              <div class="col-4"><a class="button w-100" data-number="8">8</a></div>
              <div class="col-4"><a class="button w-100" data-number="9">9</a></div>
              <div class="col-4"><a class="button-x w-100" id="clear"><i class="fa-solid fa-trash-can"></i></a></div>
              <div class="col-4"><a class="button w-100" data-number="0">0</a></div>
              <div class="col-4"><a class="button-x w-100" id="delete"><i class="fas fa-backspace"></i></a></div>
            </div>
          </div>
        </div>
        <div class="col-12 text-center">
          <p class="alert-text mt-3" style="font-size: 20px">- CEK KEMBALI NOMOR ANDA -</p>
        </div>
      </div>
    </form>
  </section>

  <!-- Modal popup -->
  <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content text-center">
        <div class="modal-header">
          <h5 class="modal-title" id="successModalLabel">Nomor Berhasil Disimpan</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <img src="assets/ceklis.png" alt="Ceklis" class="img-fluid mb-3" style="max-width: 100px;">
          <p>Nomor berhasil disimpan!</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Tutup</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function () {
      let currentInput = '';

      function formatPhoneNumber(phone) {
        let value = phone.replace(/\D/g, '');
        if (value.length > 4 && value.length <= 8) {
          return value.replace(/(\d{4})(\d+)/, '$1-$2');
        } else if (value.length > 8) {
          return value.replace(/(\d{4})(\d{4})(\d+)/, '$1-$2-$3');
        }
        return value;
      }

      $('#click-overlay').on('click', function () {
        const elem = document.body;
        if (elem.requestFullscreen) elem.requestFullscreen();
        else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
        else if (elem.msRequestFullscreen) elem.msRequestFullscreen();

        $('#click-overlay').hide();
        $('#main-content').show();
      });

      $('.button[data-number]').click(function () {
        const number = $(this).data('number');
        currentInput += number;
        $('#formatted-phone').val(formatPhoneNumber(currentInput));
        $('#raw-phone').val(currentInput);
        if (navigator.vibrate) navigator.vibrate(100);
      });

      $('#delete').click(function () {
        currentInput = currentInput.slice(0, -1);
        $('#formatted-phone').val(formatPhoneNumber(currentInput));
        $('#raw-phone').val(currentInput);
      });

      $('#clear').click(function () {
        currentInput = '';
        $('#formatted-phone').val('');
        $('#raw-phone').val('');
      });

      $('form').on('submit', function (event) {
        event.preventDefault();
        const nomor = $('#raw-phone').val();
        if (!nomor) return alert("Nomor belum diisi!");

        navigator.clipboard.writeText(nomor).catch(function (error) {
          console.error("Gagal menyalin nomor: ", error);
        });

        currentInput = '';
        $('#formatted-phone').val('');
        $('#raw-phone').val('');
        $('#successModal').modal('show');
      });
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>

</html>
